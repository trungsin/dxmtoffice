include:
  - infrastructure/nginx/docker-compose.yml
  - mailcow/docker-compose.yml
  - office/docker-compose.yml

services:
  ai-service:
    build: ./ai/service
    container_name: dxmt-ai-service
    ports:
      - "3000:3000"
    environment:
      - DEV_MODE=true
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      - AI_LOG_ENABLED=true
    networks:
      - infrastructure_default

  # Mailcow Port Overrides to avoid conflicts on 80/443
  nginx-mailcow:
    ports:
      - "8080:80"
      - "8443:443"

  sogo-mailcow:
    ports:
      - "9081:20000"

  # Office Port Overrides
  nextcloud-web:
    ports:
      - "8081:80"

  onlyoffice-app:
    ports:
      - "8082:80"

networks:
  infrastructure_default:
    external: true
  mailcow-network:
    external: true
  office-network:
    external: true
